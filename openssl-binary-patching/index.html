<!DOCTYPE html>
<html class="html" lang="en-US">
<head>
	<meta charset="UTF-8">
	<link rel="profile" href="https://gmpg.org/xfn/11">

	<title>OpenSSL binary patching &#8211; Eamon Woortman</title>
<meta name="robots" content="max-image-preview:large">
<link rel="pingback" href="https://eamonwoortman.github.io/xmlrpc.php">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="dns-prefetch" href="//use.fontawesome.com">
<link rel="alternate" type="application/rss+xml" title="Eamon Woortman &raquo; Feed" href="https://eamonwoortman.github.io/feed/">
<link rel="alternate" type="application/rss+xml" title="Eamon Woortman &raquo; Comments Feed" href="https://eamonwoortman.github.io/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Eamon Woortman &raquo; OpenSSL binary patching Comments Feed" href="https://eamonwoortman.github.io/openssl-binary-patching/feed/">
<style id="wp-emoji-styles-inline-css">img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://eamonwoortman.github.io/wp-includes/css/dist/block-library/style.min.css?ver=6.4.2" media="all">
<style id="wp-block-library-theme-inline-css">.wp-block-audio figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-audio figcaption{color:hsla(0,0%,100%,.65)}.wp-block-audio{margin:0 0 1em}.wp-block-code{border:1px solid #ccc;border-radius:4px;font-family:Menlo,Consolas,monaco,monospace;padding:.8em 1em}.wp-block-embed figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-embed figcaption{color:hsla(0,0%,100%,.65)}.wp-block-embed{margin:0 0 1em}.blocks-gallery-caption{color:#555;font-size:13px;text-align:center}.is-dark-theme .blocks-gallery-caption{color:hsla(0,0%,100%,.65)}.wp-block-image figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-image figcaption{color:hsla(0,0%,100%,.65)}.wp-block-image{margin:0 0 1em}.wp-block-pullquote{border-bottom:4px solid;border-top:4px solid;color:currentColor;margin-bottom:1.75em}.wp-block-pullquote cite,.wp-block-pullquote footer,.wp-block-pullquote__citation{color:currentColor;font-size:.8125em;font-style:normal;text-transform:uppercase}.wp-block-quote{border-left:.25em solid;margin:0 0 1.75em;padding-left:1em}.wp-block-quote cite,.wp-block-quote footer{color:currentColor;font-size:.8125em;font-style:normal;position:relative}.wp-block-quote.has-text-align-right{border-left:none;border-right:.25em solid;padding-left:0;padding-right:1em}.wp-block-quote.has-text-align-center{border:none;padding-left:0}.wp-block-quote.is-large,.wp-block-quote.is-style-large,.wp-block-quote.is-style-plain{border:none}.wp-block-search .wp-block-search__label{font-weight:700}.wp-block-search__button{border:1px solid #ccc;padding:.375em .625em}:where(.wp-block-group.has-background){padding:1.25em 2.375em}.wp-block-separator.has-css-opacity{opacity:.4}.wp-block-separator{border:none;border-bottom:2px solid;margin-left:auto;margin-right:auto}.wp-block-separator.has-alpha-channel-opacity{opacity:1}.wp-block-separator:not(.is-style-wide):not(.is-style-dots){width:100px}.wp-block-separator.has-background:not(.is-style-dots){border-bottom:none;height:1px}.wp-block-separator.has-background:not(.is-style-wide):not(.is-style-dots){height:2px}.wp-block-table{margin:0 0 1em}.wp-block-table td,.wp-block-table th{word-break:normal}.wp-block-table figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-table figcaption{color:hsla(0,0%,100%,.65)}.wp-block-video figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-video figcaption{color:hsla(0,0%,100%,.65)}.wp-block-video{margin:0 0 1em}.wp-block-template-part.has-background{margin-bottom:0;margin-top:0;padding:1.25em 2.375em}</style>
<style id="kevinbatdorf-code-block-pro-style-inline-css">.wp-block-kevinbatdorf-code-block-pro{box-sizing:border-box!important;direction:ltr!important;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;position:relative!important}.wp-block-kevinbatdorf-code-block-pro *{box-sizing:border-box!important}.wp-block-kevinbatdorf-code-block-pro pre,.wp-block-kevinbatdorf-code-block-pro pre *{font-size:inherit!important;line-height:inherit!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre{--tw-shadow:0 0 #0000!important;--tw-shadow-colored:0 0 #0000!important;background-image:none!important;border:0!important;border-radius:0!important;border-style:none!important;border-width:0!important;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important;color:inherit!important;font-family:inherit!important;margin:0!important;overflow:auto!important;overflow-wrap:normal!important;padding:16px 0 16px 16px!important;text-align:left!important;white-space:pre!important}.wp-block-kevinbatdorf-code-block-pro.padding-disabled:not(.code-block-pro-editor) pre{padding:0!important}.wp-block-kevinbatdorf-code-block-pro.padding-bottom-disabled pre{padding-bottom:0!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code{--tw-shadow:0 0 #0000!important;--tw-shadow-colored:0 0 #0000!important;background:none!important;background-color:transparent!important;border:0!important;border-radius:0!important;border-style:none!important;border-width:0!important;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)!important;color:inherit!important;display:block!important;font-family:inherit!important;margin:0!important;overflow-wrap:normal!important;padding:0!important;text-align:left!important;white-space:pre!important;width:100%!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code .line{display:inline-block!important;min-width:var(--cbp-block-width,100%)!important;vertical-align:top!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code .line{padding-left:calc(12px + var(--cbp-line-number-width, auto))!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code{counter-increment:step calc(var(--cbp-line-number-start, 1) - 1)!important;counter-reset:step!important}.wp-block-kevinbatdorf-code-block-pro pre code .line{position:relative!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre code .line:before{content:""!important;display:inline-block!important}.wp-block-kevinbatdorf-code-block-pro.cbp-has-line-numbers:not(.code-block-pro-editor) pre code .line:not(.cbp-line-number-disabled):before{color:var(--cbp-line-number-color,#999)!important;content:counter(step)!important;counter-increment:step!important;left:0!important;opacity:.5!important;position:absolute!important;text-align:right!important;transition-duration:.5s!important;transition-property:opacity!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;-webkit-user-select:none!important;-moz-user-select:none!important;user-select:none!important;width:var(--cbp-line-number-width,auto)!important}.wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover .line{min-height:var(--cbp-block-height,100%)!important}.wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,.wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{background:var(--cbp-line-highlight-color,rgb(14 165 233/.2))!important;left:-16px!important;min-height:var(--cbp-block-height,100%)!important;min-width:calc(var(--cbp-block-width, 100%) + 16px)!important;pointer-events:none!important;position:absolute!important;top:0!important;width:100%!important}[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Comic-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-.125rem!important}[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Fira-Code].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-1.5px!important}[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family="Code-Pro-Deja-Vu-Mono.ttf"].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro .line.cbp-line-highlight .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro .line.cbp-no-blur:hover .cbp-line-highlighter,[data-code-block-pro-font-family=Code-Pro-Cozette].wp-block-kevinbatdorf-code-block-pro.cbp-highlight-hover:not(.cbp-blur-enabled:not(.cbp-unblur-on-hover)) .line:hover .cbp-line-highlighter{top:-1px!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor).padding-disabled pre .line.cbp-line-highlight:after{left:0!important;width:100%!important}.wp-block-kevinbatdorf-code-block-pro.cbp-blur-enabled pre .line:not(.cbp-no-blur){filter:blur(1px)!important;opacity:.4!important;pointer-events:none!important;transition-duration:.2s!important;transition-property:all!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important}.wp-block-kevinbatdorf-code-block-pro.cbp-blur-enabled.cbp-unblur-on-hover:hover pre .line:not(.cbp-no-blur){--tw-blur:blur(0)!important;filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)!important;opacity:1!important;pointer-events:auto!important}.wp-block-kevinbatdorf-code-block-pro:not(.code-block-pro-editor) pre *{font-family:inherit!important}.cbp-see-more-simple-btn-hover{transition-property:none!important}.cbp-see-more-simple-btn-hover:hover{box-shadow:inset 0 0 100px 100px hsla(0,0%,100%,.1)!important}.code-block-pro-copy-button{background:none!important;background-color:transparent!important;border:0!important;border-style:none!important;border-width:0!important;cursor:pointer!important;left:auto!important;line-height:1!important;opacity:.1!important;padding:6px!important;position:absolute!important;right:0!important;top:0!important;transition-duration:.2s!important;transition-property:opacity!important;transition-timing-function:cubic-bezier(.4,0,.2,1)!important;z-index:10!important}.code-block-pro-copy-button:focus{opacity:.4!important}.wp-block-kevinbatdorf-code-block-pro.padding-disabled .code-block-pro-copy-button{padding:0!important}.wp-block-kevinbatdorf-code-block-pro:hover .code-block-pro-copy-button{opacity:.5!important}.wp-block-kevinbatdorf-code-block-pro .code-block-pro-copy-button:hover{opacity:.9!important}.code-block-pro-copy-button .without-check{display:block!important}.code-block-pro-copy-button .with-check,.code-block-pro-copy-button.cbp-copying .without-check{display:none!important}.code-block-pro-copy-button.cbp-copying .with-check{display:block!important}.cbp-footer-link:hover{text-decoration-line:underline!important}</style>
<style id="outermost-icon-block-style-inline-css">.wp-block-outermost-icon-block{display:flex;line-height:0}.wp-block-outermost-icon-block.has-border-color{border:none}.wp-block-outermost-icon-block .has-icon-color svg,.wp-block-outermost-icon-block.has-icon-color svg{color:currentColor}.wp-block-outermost-icon-block .has-icon-color:not(.has-no-icon-fill-color) svg,.wp-block-outermost-icon-block.has-icon-color:not(.has-no-icon-fill-color) svg{fill:currentColor}.wp-block-outermost-icon-block .icon-container{box-sizing:border-box}.wp-block-outermost-icon-block a,.wp-block-outermost-icon-block svg{height:100%;transition:transform .1s ease-in-out;width:100%}.wp-block-outermost-icon-block a:hover{transform:scale(1.1)}.wp-block-outermost-icon-block svg{transform:rotate(var(--outermost--icon-block--transform-rotate,0deg)) scaleX(var(--outermost--icon-block--transform-scale-x,1)) scaleY(var(--outermost--icon-block--transform-scale-y,1))}.wp-block-outermost-icon-block .rotate-90,.wp-block-outermost-icon-block.rotate-90{--outermost--icon-block--transform-rotate:90deg}.wp-block-outermost-icon-block .rotate-180,.wp-block-outermost-icon-block.rotate-180{--outermost--icon-block--transform-rotate:180deg}.wp-block-outermost-icon-block .rotate-270,.wp-block-outermost-icon-block.rotate-270{--outermost--icon-block--transform-rotate:270deg}.wp-block-outermost-icon-block .flip-horizontal,.wp-block-outermost-icon-block.flip-horizontal{--outermost--icon-block--transform-scale-x:-1}.wp-block-outermost-icon-block .flip-vertical,.wp-block-outermost-icon-block.flip-vertical{--outermost--icon-block--transform-scale-y:-1}.wp-block-outermost-icon-block .flip-vertical.flip-horizontal,.wp-block-outermost-icon-block.flip-vertical.flip-horizontal{--outermost--icon-block--transform-scale-x:-1;--outermost--icon-block--transform-scale-y:-1}</style>
<style id="classic-theme-styles-inline-css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<style id="global-styles-inline-css">body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flow > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-flow > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-flow > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignleft{float: left;margin-inline-start: 0;margin-inline-end: 2em;}body .is-layout-constrained > .alignright{float: right;margin-inline-start: 2em;margin-inline-end: 0;}body .is-layout-constrained > .aligncenter{margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > :where(:not(.alignleft):not(.alignright):not(.alignfull)){max-width: var(--wp--style--global--content-size);margin-left: auto !important;margin-right: auto !important;}body .is-layout-constrained > .alignwide{max-width: var(--wp--style--global--wide-size);}body .is-layout-flex{display: flex;}body .is-layout-flex{flex-wrap: wrap;align-items: center;}body .is-layout-flex > *{margin: 0;}body .is-layout-grid{display: grid;}body .is-layout-grid > *{margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
.wp-block-navigation a:where(:not(.wp-element-button)){color: inherit;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
.wp-block-pullquote{font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="ew-dhmpw-style-css" href="https://eamonwoortman.github.io/wp-content/plugins/eawo-profile-widget-dockerhub/eawo-profile-widget-dockerhub.css?ver=6.4.2" media="all">
<link rel="stylesheet" id="f13-gmpw-style-css" href="https://eamonwoortman.github.io/wp-content/plugins/f13-github-mini-profile-widget/github-profile-widget.css?ver=6.4.2" media="all">
<link rel="stylesheet" id="oceanwp-style-css" href="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/css/style.min.css?ver=1.0" media="all">
<link rel="stylesheet" id="child-style-css" href="https://eamonwoortman.github.io/wp-content/themes/oceanwp-child-theme-master/style.css?ver=3.4.3" media="all">
<link rel="stylesheet" id="font-awesome-css" href="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/fonts/fontawesome/css/all.min.css?ver=5.15.1" media="all">
<link rel="stylesheet" id="simple-line-icons-css" href="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/css/third/simple-line-icons.min.css?ver=2.4.0" media="all">
<link rel="stylesheet" id="font-awesome-official-css" href="https://use.fontawesome.com/releases/v6.4.0/css/all.css" media="all" integrity="sha384-iw3OoTErCYJJB9mCa8LNS2hbsQ7M3C0EpIsO/H5+EGAkPGc6rk+V8i04oW/K5xq0" crossorigin="anonymous">
<link rel="stylesheet" id="wp-gitlab-css" href="https://eamonwoortman.github.io/wp-content/plugins/wp-gitlab/wp-gitlab.css?ver=6.4.2" media="all">
<link rel="stylesheet" id="oe-widgets-style-css" href="https://eamonwoortman.github.io/wp-content/plugins/ocean-extra/assets/css/widgets.css?ver=6.4.2" media="all">
<link rel="stylesheet" id="font-awesome-official-v4shim-css" href="https://use.fontawesome.com/releases/v6.4.0/css/v4-shims.css" media="all" integrity="sha384-TjXU13dTMPo+5ZlOUI1IGXvpmajjoetPqbUJqTx+uZ1bGwylKHNEItuVe/mg/H6l" crossorigin="anonymous">
<script src="https://eamonwoortman.github.io/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script src="https://eamonwoortman.github.io/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="https://eamonwoortman.github.io/wp-json/">
<link rel="alternate" type="application/json" href="https://eamonwoortman.github.io/wp-json/wp/v2/posts/720">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://eamonwoortman.github.io/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.4.2">
<link rel="canonical" href="https://eamonwoortman.github.io/openssl-binary-patching/">
<link rel="shortlink" href="https://eamonwoortman.github.io/?p=720">
<link rel="alternate" type="application/json+oembed" href="https://eamonwoortman.github.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhttps%3A%2F%2Feamonwoortman.github.io%2Fopenssl-binary-patching%2F">
<link rel="alternate" type="text/xml+oembed" href="https://eamonwoortman.github.io/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fhttps%3A%2F%2Feamonwoortman.github.io%2Fopenssl-binary-patching%2F#038;format=xml">
		<style id="wp-custom-css">.portfolio-info-panel{border-bottom-right-radius:5px;border-bottom-left-radius:5px;border:2px solid rgba(204,204,204,0.09);width:100%;color:#888888;font-family:'Raleway',sans-serif;background-color:#fafafa}.portfolio-info-panel ul li{list-style:none;margin-bottom:2px;width:650px}.portfolio-info-panel ul{display:flex;flex-wrap:wrap}.bmc-btn-container{margin:1.5em auto;max-width:700px}.wp-block-kevinbatdorf-code-block-pro{margin:1.5em auto;max-width:700px}.portfolio-info-panel p{/* margin:16px 0;*/padding:5px 10px 5px 10px}.portfolio-header{margin:1.5em auto;max-width:700px}.entry-box header .entry-date,.entry-box header .entry-comments{color:#888888;font-family:'Raleway',sans-serif;margin-right:15px}.entry-box header .entry-date span,.entry-box header .entry-comments span{margin-right:7px}.wp-block-table{margin:1.5em auto;max-width:fit-content}</style>
		<!-- OceanWP CSS -->
<style type="text/css">.background-image-page-header-overlay{opacity:0.2}.page-header{background-image:url( https://eamonwoortman.github.io/wp-content/uploads/2023/05/OpenSSL-screen2.png) !important;height:180px}/* General CSS */.container{width:1000px}@media only screen and (min-width:960px){.content-area,.content-left-sidebar .content-area{width:90%}}/* Header CSS */#site-header.has-header-media .overlay-header-media{background-color:rgba(0,0,0,0.5)}</style>
</head>

<body class="post-template-default single single-post postid-720 single-format-standard wp-embed-responsive oceanwp-theme dropdown-mobile default-breakpoint content-full-width content-max-width post-in-category-general has-topbar page-with-background-title has-breadcrumbs has-blog-grid" itemscope="itemscope" itemtype="https://schema.org/Article">

	
	
	<div id="outer-wrap" class="site clr">

		<a class="skip-link screen-reader-text" href="#main">Skip to content</a>

		
		<div id="wrap" class="clr">

			

<div id="top-bar-wrap" class="clr">

	<div id="top-bar" class="clr container has-no-content">

		
		<div id="top-bar-inner" class="clr">

			

		</div>
<!-- #top-bar-inner -->

		
	</div>
<!-- #top-bar -->

</div>
<!-- #top-bar-wrap -->


			
<header id="site-header" class="minimal-header clr" data-height="74" itemscope="itemscope" itemtype="https://schema.org/WPHeader" role="banner">

	
					
			<div id="site-header-inner" class="clr container">

				
				

<div id="site-logo" class="clr" itemscope itemtype="https://schema.org/Brand">

	
	<div id="site-logo-inner" class="clr">

						<a href="https://eamonwoortman.github.io/" rel="home" class="site-title site-logo-text">Eamon Woortman</a>
				
	</div>
<!-- #site-logo-inner -->

	
	
</div>
<!-- #site-logo -->

			<div id="site-navigation-wrap" class="clr">
			
			
			
			<nav id="site-navigation" class="navigation main-navigation clr" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement" role="navigation">

				<ul id="menu-main-navigation-menu" class="main-menu dropdown-menu sf-menu">
<li id="menu-item-290" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-290"><a href="https://eamonwoortman.github.io/" class="menu-link"><span class="text-wrap">Home</span></a></li>
<li id="menu-item-323" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-323"><a href="https://eamonwoortman.github.io/blog/" class="menu-link"><span class="text-wrap">Blog</span></a></li>
<li id="menu-item-597" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-597"><a href="https://eamonwoortman.github.io/projects/" class="menu-link"><span class="text-wrap">Projects</span></a></li>
<li id="menu-item-284" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-284"><a href="https://eamonwoortman.github.io/contact/" class="menu-link"><span class="text-wrap">Contact</span></a></li>
<li class="search-toggle-li"><a href="https://eamonwoortman.github.io/#" class="site-search-toggle search-dropdown-toggle"><span class="screen-reader-text">Toggle website search</span><i class=" icon-magnifier" aria-hidden="true" role="img"></i></a></li>
</ul>
<div id="searchform-dropdown" class="header-searchform-wrap clr">
	
<form aria-label="Search this website" role="search" method="get" class="searchform" action="https://eamonwoortman.github.io/">	
	<input aria-label="Insert search query" type="search" id="ocean-search-form-1" class="field" autocomplete="off" placeholder="Search" name="s">
			<input type="hidden" name="post_type" value="project">
		</form>
</div>
<!-- #searchform-dropdown -->

			</nav><!-- #site-navigation -->

			
			
					</div>
<!-- #site-navigation-wrap -->
			
		
	
				
	
	<div class="oceanwp-mobile-menu-icon clr mobile-right">

		
		
		
		<a href="https://eamonwoortman.github.io/#mobile-menu-toggle" class="mobile-menu" aria-label="Mobile Menu">
							<i class="fa fa-bars" aria-hidden="true"></i>
								<span class="oceanwp-text">Menu</span>
				<span class="oceanwp-close-text">Close</span>
						</a>

		
		
		
	</div>
<!-- #oceanwp-mobile-menu-navbar -->

	

			</div>
<!-- #site-header-inner -->

			
<div id="mobile-dropdown" class="clr">

	<nav class="clr" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement">

		<ul id="menu-main-navigation-menu-1" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-290"><a href="https://eamonwoortman.github.io/">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-323"><a href="https://eamonwoortman.github.io/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-597"><a href="https://eamonwoortman.github.io/projects/">Projects</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-284"><a href="https://eamonwoortman.github.io/contact/">Contact</a></li>
<li class="search-toggle-li"><a href="https://eamonwoortman.github.io/#" class="site-search-toggle search-dropdown-toggle"><span class="screen-reader-text">Toggle website search</span><i class=" icon-magnifier" aria-hidden="true" role="img"></i></a></li>
</ul>
<div id="mobile-menu-search" class="clr">
	<form aria-label="Search this website" method="get" action="https://eamonwoortman.github.io/" class="mobile-searchform">
		<input aria-label="Insert search query" value="" class="field" id="ocean-mobile-search-2" type="search" name="s" autocomplete="off" placeholder="Search">
		<button aria-label="Submit search" type="submit" class="searchform-submit">
			<i class=" icon-magnifier" aria-hidden="true" role="img"></i>		</button>
					<input type="hidden" name="post_type" value="project">
					</form>
</div>
<!-- .mobile-menu-search -->

	</nav>

</div>

			
			
		
		
</header><!-- #site-header -->


			
			<main id="main" class="site-main clr" role="main">

				

<header class="page-header background-image-page-header">

	
	<div class="container clr page-header-inner">

		
			<h1 class="page-header-title clr" itemprop="headline">Blog</h1>

			
		
		<nav aria-label="Breadcrumbs" class="site-breadcrumbs clr position-" itemprop="breadcrumb"><ol class="trail-items" itemscope itemtype="http://schema.org/BreadcrumbList">
<meta name="numberOfItems" content="3">
<meta name="itemListOrder" content="Ascending">
<li class="trail-item trail-begin" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
<a href="https://eamonwoortman.github.io/" rel="home" aria-label="Home" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name"><i class=" icon-home" aria-hidden="true" role="img"></i><span class="breadcrumb-home has-icon">Home</span></span></a><span class="breadcrumb-sep">></span><meta content="1" itemprop="position">
</li>
<li class="trail-item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
<a href="https://eamonwoortman.github.io/category/general/" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">General</span></a><span class="breadcrumb-sep">></span><meta content="2" itemprop="position">
</li>
<li class="trail-item trail-end" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
<a href="https://eamonwoortman.github.io/openssl-binary-patching/" itemtype="https://schema.org/Thing" itemprop="item"><span itemprop="name">OpenSSL binary patching</span></a><meta content="3" itemprop="position">
</li>
</ol></nav>
	</div>
<!-- .page-header-inner -->

	<span class="background-image-page-header-overlay"></span>
	
</header><!-- .page-header -->


	
	<div id="content-wrap" class="container clr">

		
		<div id="primary" class="content-area clr">

			
			<div id="content" class="site-content clr">

				
				
<article id="post-720">

	

<header class="entry-header clr">
	<h2 class="single-post-title entry-title" itemprop="headline">OpenSSL binary patching</h2>
<!-- .single-post-title -->
</header><!-- .entry-header -->


<ul class="meta ospm-default clr">

	
					<li class="meta-author" itemprop="name">
<span class="screen-reader-text">Post author:</span><i class=" icon-user" aria-hidden="true" role="img"></i><a href="https://eamonwoortman.github.io/author/eamon/" title="Posts by eamon" rel="author" itemprop="author" itemscope="itemscope" itemtype="https://schema.org/Person">eamon</a>
</li>
		
		
		
		
		
		
	
		
					<li class="meta-date" itemprop="datePublished">
<span class="screen-reader-text">Post published:</span><i class=" icon-clock" aria-hidden="true" role="img"></i>May 20, 2023</li>
		
		
		
		
		
	
		
		
		
					<li class="meta-cat">
<span class="screen-reader-text">Post category:</span><i class=" icon-folder" aria-hidden="true" role="img"></i><a href="https://eamonwoortman.github.io/category/general/" rel="category tag">General</a>
</li>
		
		
		
	
		
		
		
		
		
					<li class="meta-comments">
<span class="screen-reader-text">Post comments:</span><i class=" icon-bubble" aria-hidden="true" role="img"></i><a href="https://eamonwoortman.github.io/openssl-binary-patching/#respond" class="comments-link">0 Comments</a>
</li>
		
	
</ul>



<div class="entry-content clr" itemprop="text">
	
<p class="has-text-color" style="color:rgb(0, 0, 0)">This document describes steps taken to binary patch a crash that was occurring in Besiege (Microsoft Store, 64-bit) and the 64-bit Unity Editor.</p>



<p class="has-background" style="background-color:rgb(241, 241, 239)">üí° Source code is available on GitHub: <a href="https://github.com/eamonwoortman/openssl-universal-patcher/" target="_blank" rel="noreferrer noopener">https://github.com/eamonwoortman/openssl-universal-patcher/</a></p>



<h1 class="wp-block-heading">Introduction üìñ</h1>



<p class="has-text-color" style="color:rgb(0, 0, 0)">At the time of writing, we are trying to deploy a new update for Besiege on the Xbox PC/Microsoft Store platform.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">However, a couple of users have reported that the game doesn&#8217;t open or crashes immediately. The crash logs that we received all contained the last stack trace line: <code>invalid_pointer_read_c0000005_besiege.exe!sha1_block_data_order</code>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">After troubleshooting, we narrowed the problem down to our workshop integration (<a href="http://mod.io/" target="_blank" rel="noreferrer noopener">Mod.io</a>). It was trying to establish an HTTPS connection through the <a href="https://docs.unity3d.com/ScriptReference/Networking.UnityWebRequest.html" target="_blank" rel="noreferrer noopener">UnityWebRequest</a>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Besiege was built with the older <em>64-bit 5.4.0f3 Unity</em> version, which used the <code>1.1.0-dev</code> OpenSSL library. It appears that in the Unity 5.4.0f3 Editor, and builds made with it, there&#8217;s a bug where apps that use OpenSSL (i.e., secure web request) crash for users with specific hardware specifications, specifically 10th Gen and 11th Gen Intel CPUs.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">One of our team members actually had one of these Intel models, and not only did the game build crash, but the <em>64-bit 5.4.0f3 Unity Editor</em> also crashed upon launching.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">A Reddit user called ‚Äòshishire‚Äô and commenters have already described the problem in <a href="https://www.reddit.com/r/Smite/comments/pl35y6/comment/he16988/?utm_source=share&amp;utm_medium=web2x&amp;context=3" target="_blank" rel="noreferrer noopener">this topic</a>; </p>



<blockquote class="wp-block-quote has-text-color" style="color:rgb(0, 0, 0)">
<p><em>The actual failure going on here on 64-bit is happening in a dll called MctsInterface.dll, and it&#8217;s occurring during a pointer dereference to a floating point number that tries to access memory that&#8217;s outside the bounds of what&#8217;s actually available to the application. That being said, one of the things I noticed is that the function this is a part of does a whole bunch of sha1sum operations in cpu-space.</em></p>
</blockquote>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Additionally, Intel has released a short article about the issue. You can read <a rel="noreferrer noopener" href="https://www.intel.com/content/www/us/en/developer/articles/troubleshooting/openssl-sha-crash-bug-requires-application-update.html" target="_blank">their article</a> for more information and additional workarounds.</p>



<h2 class="wp-block-heading"><strong>Existing Workaround</strong></h2>



<p class="has-text-color" style="color:rgb(0, 0, 0)">There&#8217;s a workaround to the crash that involves setting an environment variable on the system. This variable instructs OpenSSL to use software-based hashing instead of hardware-based hashing. This solution doesn&#8217;t require patching the OpenSSL binary and may be simpler for some users.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">To set the environment variable, follow these steps:</p>



<ol>
<li>Open the Control Panel and navigate to System and Security &gt; System &gt; Advanced system settings.</li>



<li>Click on the Environment Variables button.</li>



<li>Under System Variables, click on New and enter the following information:</li>



<li>Click OK to save the changes.</li>
</ol>



<p class="has-text-color" style="color:rgb(0, 0, 0)">After setting the environment variable, restart the affected application, and it should now be able to use OpenSSL without crashing.</p>



<h2 class="wp-block-heading"><strong>Patching motivation</strong></h2>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Although this workaround might work for some users, it is not a permanent fix. In fact, without the workaround, users would experience a crash immediately after downloading the game.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">If users are eager to play the game, they might search the internet for a solution. However, even if they find it, it requires changing the system environment variables, which can be daunting for regular users.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">This does not provide a great user experience, so we sought a way to patch our game.</p>



<h1 class="wp-block-heading">My patching journey ü©π</h1>



<h3 class="wp-block-heading">Attempt #1: Calling ‚ÄòSetEnvironmentVariable‚Äô ‚ùå</h3>



<p class="has-text-color" style="color:rgb(0, 0, 0)">I first set out to try to replicate the environment variable workaround through code.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">My thoughts were that if the user can fix it by setting a specific environment variable before launching it, perhaps we could set the variable ourselves from within the game.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">C# has a way of setting application-specific environment variables through <a rel="noreferrer noopener" href="https://learn.microsoft.com/en-us/dotnet/api/system.environment.setenvironmentvariable?view=netframework-4.0" target="_blank">Environment.SetEnvironmentVariable()</a>. So I used it to set the <code>OPENSSL_ia32cap</code> variable to <code>~0x20000000</code>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">However, after trying it, we found that the game was still crashing, even though the process&#8217;s environment variable has changed.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">After thinking about it some more, this is probably because the OpenSSL initialization is part of the native Unity player and is already initialized before the mono domain is created. One way of how I could see this type of fix working is to wrap your game executable with another app (C# in this case) that would use <code>SetEnvironmentVariable()</code> before launching the inner app.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Unfortunately, we don&#8217;t have any wrapper application around our game, so we can&#8217;t set the environment variable like this.</p>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide">



<p class="has-text-color" style="color:rgb(0, 0, 0)">üöß Roadblock 1</p>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide">



<h2 class="wp-block-heading">Attempt #2: Binary patching ‚ùå</h2>



<p class="has-text-color" style="color:rgb(0, 0, 0)">My next attempt would be to either patch the game executable to always set the <code>OPENSSL_ia32cap</code> to <code>~0x20000000</code> or somehow patch the function that would use the flag&#8217;s value.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">I looked up the OpenSSL repository and found a function called <code>OPENSSL_cpuid_setup</code> in <a href="https://github.com/openssl/openssl/blob/c8093347f736c7991350d26048b680d0e64974a0/crypto/cpuid.c#L106" target="_blank" rel="noreferrer noopener">cpuid.c</a>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">The <code>OPENSSL_cpuid_setup</code> function is responsible for initializing the OpenSSL library. It checks the processor vendor ID and feature flags to determine which cryptographic algorithms are available and whether hardware acceleration is supported. The function sets the <code>OPENSSL_ia32cap</code> environment variable based on the processor&#8217;s capabilities.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">I opened the game binary in <a href="https://hex-rays.com/ida-free/" target="_blank" rel="noreferrer noopener">IDA</a> and looked up the same function. At the very end, I found the instruction that would set the <code>OPENSSL_ia32cap</code> variable;</p>



<figure class="wp-block-image size-large"><img class="lazy lazy-hidden" decoding="async" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="https://eamonwoortman.github.io/wp-content/uploads/2023/05/image.png" alt=""><noscript><img decoding="async" src="https://eamonwoortman.github.io/wp-content/uploads/2023/05/image.png" alt=""></noscript></figure>



<p class="has-text-color" style="color:rgb(0, 0, 0)">My options here were either to patch that part of the method so it would always unset the <code>0x20000000</code> value from the <code>OPENSSL_ia32cap</code> flag or to somehow force the environment variable setting to be a constant string of <code>"~0x20000000"</code>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">I was in the middle of trying the first option, but I then realized I would need more instructions (more bytes) than were present. I couldn&#8217;t simply replace an existing instruction without altering the functionality.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">After reading up on it, I learned that inserting instructions means looking up some kind of NOP/empty part of the binary and jumping to there from the original code.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Because I have limited assembly/cracking experience, I wasn&#8217;t comfortable with doing this. So I decided to stop this experiment and look for alternatives.</p>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide">



<p class="has-text-color" style="color:rgb(0, 0, 0)">üöß Roadblock 2</p>



<hr class="wp-block-separator has-alpha-channel-opacity is-style-wide">



<h2 class="wp-block-heading">Attempt #3: Binary patching (2) ‚úÖ</h2>



<p class="has-text-color" style="color:rgb(0, 0, 0)">While looking into setting the environment variable, I stumbled upon one of my many open browser tabs that actually contained the fix that <a href="https://github.com/openssl/openssl/commit/7123aa81e9fb19afb11fdf3850662c5f7ff1f19c#diff-fd85954e17364d4495e1e077a5768e4e" target="_blank" rel="noreferrer noopener">OpenSSL did in their 1.0.2L patch</a>.</p>



<figure class="wp-block-image size-large"><img class="lazy lazy-hidden" decoding="async" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="https://eamonwoortman.github.io/wp-content/uploads/2023/05/image-1-1024x278.png" alt=""><noscript><img decoding="async" src="https://eamonwoortman.github.io/wp-content/uploads/2023/05/image-1-1024x278.png" alt=""></noscript></figure>



<p class="has-text-color" style="color:rgb(0, 0, 0)">This patched a function called <code>sha1_block_data_order_shaext</code>, which was the Intel-specific implementation of the SHA1 <code>sha1_block_data_order</code> function.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">It‚Äôs not a coincidence that the crashes that users reported were all caused in a function called <code>sha1_block_data_order</code>.</p>



<h3 class="wp-block-heading">Finding the instructions to patch</h3>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Next up was to use IDA and find the corresponding instruction in the game executable. I actually built the patched OpenSSL earlier, so I opened the <code>openssl</code> lib in there and looked up the original <code>sha1_block_data_order_shaext</code> function.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Looking up the function name was enough to take me to the corresponding function block.</p>



<figure class="wp-block-image size-large"><img class="lazy lazy-hidden" decoding="async" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="https://eamonwoortman.github.io/wp-content/uploads/2023/05/image-2-1024x615.png" alt=""><noscript><img decoding="async" src="https://eamonwoortman.github.io/wp-content/uploads/2023/05/image-2-1024x615.png" alt=""></noscript></figure>



<p class="has-text-color" style="color:rgb(0, 0, 0)">And we actually found the <em><strong>patched</strong></em> instructions we needed;</p>



<div class="wp-block-kevinbatdorf-code-block-pro" style="font-size:.875rem;line-height:1.25rem">
<span role="button" tabindex="0" data-code="lea     r8, [rsi+40h]
...
cmovnz  rsi, r8" style="color:#adbac7;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki github-dark-dimmed" style="background-color: #22272e" tabindex="0"><code><span class="line"><span style="color: #F47067">lea</span><span style="color: #ADBAC7">     </span><span style="color: #6CB6FF">r8</span><span style="color: #ADBAC7">, [</span><span style="color: #6CB6FF">rsi</span><span style="color: #ADBAC7">+</span><span style="color: #6CB6FF">40h</span><span style="color: #ADBAC7">]</span></span>
<span class="line"><span style="color: #ADBAC7">...</span></span>
<span class="line"><span style="color: #F47067">cmovnz</span><span style="color: #ADBAC7">  </span><span style="color: #6CB6FF">rsi</span><span style="color: #ADBAC7">, </span><span style="color: #6CB6FF">r8</span></span></code></pre>
</div>



<p class="has-text-color" style="color:rgb(0, 0, 0)">From the earlier patch commit on <a href="https://github.com/openssl/openssl/commit/7123aa81e9fb19afb11fdf3850662c5f7ff1f19c#diff-fd85954e17364d4495e1e077a5768e4e" target="_blank" rel="noreferrer noopener">OpenSSL&#8217;s GitHub Repo</a>, we already know they changed the <code>RAX</code> register to <code>R8</code>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">So to look up the instruction we needed in our game binary, we simply need to reverse the patch;</p>



<div class="wp-block-kevinbatdorf-code-block-pro" style="font-size:.875rem;line-height:1.25rem">
<span role="button" tabindex="0" data-code="lea     rax, [rsi+40h]
...
cmovnz  rsi, rax" style="color:#adbac7;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki github-dark-dimmed" style="background-color: #22272e" tabindex="0"><code><span class="line"><span style="color: #F47067">lea</span><span style="color: #ADBAC7">     </span><span style="color: #6CB6FF">rax</span><span style="color: #ADBAC7">, [</span><span style="color: #6CB6FF">rsi</span><span style="color: #ADBAC7">+</span><span style="color: #6CB6FF">40h</span><span style="color: #ADBAC7">]</span></span>
<span class="line"><span style="color: #ADBAC7">...</span></span>
<span class="line"><span style="color: #F47067">cmovnz</span><span style="color: #ADBAC7">  </span><span style="color: #6CB6FF">rsi</span><span style="color: #ADBAC7">, </span><span style="color: #6CB6FF">rax</span></span></code></pre>
</div>



<h3 class="wp-block-heading">Matching the patch instructions in our game</h3>



<p class="has-text-color" style="color:rgb(0, 0, 0)">With the new information on what instructions we needed to look out for, we can start matching them in our game binary.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">In IDA, opened up our game binary, and jumped to the <code>sha1_block_data_order</code> function and found the corresponding instructions (<code>lea rax‚Ä¶, cmovnz rsi ‚Ä¶</code>) in a block after a couple of jumps.</p>



<figure class="wp-block-image size-large"><img class="lazy lazy-hidden" decoding="async" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="https://eamonwoortman.github.io/wp-content/uploads/2023/05/image-3-1024x590.png" alt=""><noscript><img decoding="async" src="https://eamonwoortman.github.io/wp-content/uploads/2023/05/image-3-1024x590.png" alt=""></noscript></figure>



<p class="has-text-color" style="color:rgb(0, 0, 0)">To-be-patched instructions, 4 bytes apart</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">If we observe the Hex View on the right, you‚Äôll notice that I‚Äôve also marked the corresponding bytes of the two to-be-patched instructions. Observant developers will notice there are 4 bytes between the two instructions; this will be important later.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">I wanted to verify what I was seeing is correct. Since I‚Äôm not fluent in assembly and bytecode, instead of Googling and reading up on assembly instructions, I asked ChatGPT what the corresponding bytes are for each instruction.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">At the time of writing, the AI chatbot was still benevolent and obedient, so it told me the answer;</p>



<div class="wp-block-kevinbatdorf-code-block-pro" style="font-size:.875rem;line-height:1.25rem">
<span role="button" tabindex="0" data-code="# lea     rax, [rsi+40h]
48 8D 46 40

# cmovnz  rsi, rax
48 0F 45 F0" style="color:#adbac7;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki github-dark-dimmed" style="background-color: #22272e" tabindex="0"><code><span class="line"><span style="color: #ADBAC7"># lea     rax, [rsi+40h]</span></span>
<span class="line"><span style="color: #6CB6FF">48</span><span style="color: #ADBAC7"> 8D </span><span style="color: #6CB6FF">46</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">40</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADBAC7"># cmovnz  rsi, rax</span></span>
<span class="line"><span style="color: #6CB6FF">48</span><span style="color: #ADBAC7"> 0F </span><span style="color: #6CB6FF">45</span><span style="color: #ADBAC7"> F0</span></span></code></pre>
</div>



<p class="has-text-color" style="color:rgb(0, 0, 0)">This matches what we‚Äôve seen in the Hex View! ü§ò</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">I also asked GPT (we go on first-name basis now) to tell me what byte to change if I wanted to change the address from <code>rax</code> to <code>r8</code>, and it basically gave me a patchable diff;</p>



<div class="wp-block-kevinbatdorf-code-block-pro" style="font-size:.875rem;--cbp-line-highlight-color:rgba(139, 186, 234, 0.2);line-height:1.25rem">
<span role="button" tabindex="0" data-code="-- First sequence --
# lea     rax, [rsi+40h]
original: 48 8D 46 40
# lea     r8, [rsi+40h]
patched: 4C 8D 46 40

...

-- Second sequence --
# cmovnz  rsi, rax
original: 48 0F 45 F0
# cmovnz  rsi, r8
patched: 49 0F 45 F0" style="color:#adbac7;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki github-dark-dimmed" style="background-color: #22272e" tabindex="0"><code><span class="line"><span style="color: #F69D50">--</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">First</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sequence</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--</span></span>
<span class="line"><span style="color: #768390"># lea     rax, [rsi+40h]</span></span>
<span class="line"><span style="color: #F69D50">original:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">48</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">8</span><span style="color: #96D0FF">D</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">46</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">40</span></span>
<span class="line"><span style="color: #768390"># lea     r8, [rsi+40h]</span></span>
<span class="line cbp-line-highlight"><span style="color: #F69D50">patched:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">4</span><span style="color: #96D0FF">C</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">8</span><span style="color: #96D0FF">D</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">46</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">40</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6CB6FF">...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F69D50">--</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">Second</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sequence</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--</span></span>
<span class="line"><span style="color: #768390"># cmovnz  rsi, rax</span></span>
<span class="line"><span style="color: #F69D50">original:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">48</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">0</span><span style="color: #96D0FF">F</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">45</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">F0</span></span>
<span class="line"><span style="color: #768390"># cmovnz  rsi, r8</span></span>
<span class="line cbp-line-highlight"><span style="color: #F69D50">patched:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">49</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">0</span><span style="color: #96D0FF">F</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">45</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">F0</span></span></code></pre>
</div>



<p class="has-background" style="background-color:rgb(241, 241, 239)">üí° Note: I‚Äôm aware you can change instructions in IDA by using Edit ‚Üí Patch Program ‚Üí Assemble. But when I tried changing <code>rax</code> to <code>r8</code>, IDA refused with an ‚ÄúInvalid Operand‚Äù error. According to this Stack Overflow reply, it‚Äôs because the Assemble patcher only supports a limited amount of operations; <a href="https://stackoverflow.com/a/38529308" target="_blank" rel="noreferrer noopener">https://stackoverflow.com/a/38529308</a>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">With the diff file generated, I can use it to apply the patch to the game binary file programmatically. This will allow for easier and faster patching of the game binary file for each new build.</p>



<h1 class="wp-block-heading">Next step; Write a patcher program ‚úçÔ∏è</h1>



<p class="has-text-color" style="color:rgb(0, 0, 0)">
Now we only need to write a simple program that patches the game binary file. </p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Once we have a patcher, we can include it in our build pipeline before packaging the game.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">IDA does provide a diff/patching method, but it uses a fixed memory offset. This doesn‚Äôt work if we‚Äôre going to update the game after the initial patch as the memory offsets change due to changes in code. So we need something that‚Äôs a bit more clever than a simple offset byte patcher. </p>



<h2 class="wp-block-heading">BSDiff / BSPatch</h2>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Before writing my own diffing and patching tool, I searched for an existing one and found , or more specifically, its .NET port: .</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">To create a diff, I first needed to patch our game binary (<code>Besiege.exe</code>). I used the byte code provided by GPT and applied the patch in IDA (Edit ‚Üí Patch Program ‚Üí Change Byte), saving a new patched game binary (<code>Besiege.patched.exe</code>).</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Next, I used <strong>bsdiff </strong>to create a diff between the old, unpatched game binary and the freshly patched one.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Using this diff/patch file, I was able to patch a fresh new game build, even with code changes, and verified that the patch was working. I implemented the patcher in our build pipeline by calling <strong>bspatch</strong> after every successful build, just before packaging it.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)"><strong>Success, right?</strong></p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Not quite&#8230;</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">While this method would work for our own game, unfortunately, on this particular platform, this patch wouldn&#8217;t work on <em>any</em> application that was built on this old OpenSSL library.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Although my goal isn&#8217;t to make a universal patcher, I&#8217;m not sure how well this BSDiff patch holds up against massive code changes.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">And to be completely honest, I wanted to see if it was possible to create a more universal patcher so we could fix the <em>Unity 5.4.0f3 64-bit</em> <em>Editor</em> from crashing, for example.</p>



<h2 class="wp-block-heading">Writing our own patcher </h2>



<h3 class="wp-block-heading">The patch</h3>



<p class="has-text-color" style="color:rgb(0, 0, 0)">So we know we only have to patch <em>2 bytes, </em>one for the <code>lea</code> instruction and one for the <code>cmovnz</code> instruction. We also know the sequence they‚Äôre in and even the relative offset relative to each other, which is <em>4 bytes</em>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Now we can hardcode this into our patcher, but for the sake of readability and transparency, I decided to put all the patching information in a <a href="https://github.com/eamonwoortman/openssl-universal-patcher/blob/master/src/OpenSSLUniversalPatcher/Resources/openssl.universal.patch" target="_blank" rel="noreferrer noopener">single text file</a>.</p>



<div class="wp-block-kevinbatdorf-code-block-pro" style="font-size:.875rem;line-height:1.25rem">
<span role="button" tabindex="0" data-code="# lea     rax, [rsi+40h]
original: 48 8D 46 40
# lea     r8, [rsi+40h]
patched: 4C 8D 46 40
# 4 bytes from the previous instruction
offset: 4
# cmovnz  rsi, rax
original: 48 0F 45 F0
# cmovnz  rsi, r8
patched: 49 0F 45 F0" style="color:#adbac7;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki github-dark-dimmed" style="background-color: #22272e" tabindex="0"><code><span class="line"><span style="color: #768390"># lea     rax, [rsi+40h]</span></span>
<span class="line"><span style="color: #F69D50">original:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">48</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">8</span><span style="color: #96D0FF">D</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">46</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">40</span></span>
<span class="line"><span style="color: #768390"># lea     r8, [rsi+40h]</span></span>
<span class="line"><span style="color: #F69D50">patched:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">4</span><span style="color: #96D0FF">C</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">8</span><span style="color: #96D0FF">D</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">46</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">40</span></span>
<span class="line"><span style="color: #768390"># 4 bytes from the previous instruction</span></span>
<span class="line"><span style="color: #F69D50">offset:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">4</span></span>
<span class="line"><span style="color: #768390"># cmovnz  rsi, rax</span></span>
<span class="line"><span style="color: #F69D50">original:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">48</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">0</span><span style="color: #96D0FF">F</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">45</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">F0</span></span>
<span class="line"><span style="color: #768390"># cmovnz  rsi, r8</span></span>
<span class="line"><span style="color: #F69D50">patched:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">49</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">0</span><span style="color: #96D0FF">F</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">45</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">F0</span></span></code></pre>
</div>



<p>openssl.universal.patch</p>



<h3 class="wp-block-heading">The patching application</h3>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Once again, I asked ChatGPT to help me get started, and it did an okay job of outlining the patcher application. Although it was broken at first, it provided enough groundwork to get me started.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">The C# console application will perform the following steps:</p>



<ul>
<li>Load the <strong>target binary</strong> as a <code>byte</code> array</li>



<li>Parse the <strong>patch file</strong> into a <code>Patch</code> class</li>



<li>Find any number of occurrences of the byte sequences that need to be patched</li>



<li>Replace these byte sequences in the original <code>byte</code> array with our patched bytes, but only if exactly one occurrence is found</li>



<li>Write the patched bytes to a new binary file</li>
</ul>



<p class="has-text-color" style="color:rgb(0, 0, 0)">The main patching method ended up looking like this; </p>



<div class="wp-block-kevinbatdorf-code-block-pro" style="font-size:.875rem;line-height:1.25rem">
<span role="button" tabindex="0" data-code="public static bool Apply(string inputPath, string outputPath, string patchFileText) {
	byte[] originalBytes = File.ReadAllBytes(inputPath);
	Patch patch = ParsePatchFile(patchFileText);

	List&lt;PatternOffsets&gt; offsets = FindSequencePattern(originalBytes, patch.FirstSequence, patch.SecondSequence, patch.RelativeOffset);
	if (offsets.Count == 0) {
		Console.Error.WriteLine(&quot;Error, pattern not found in target.&quot;);
		return false;
	}
	if (offsets.Count &gt; 1) {
		Console.Error.WriteLine(&quot;Error, pattern found multiple times in target.&quot;);
		return false;
	}

	Console.WriteLine(&quot;Sequence pattern found in target, patching...&quot;);

	var patternOffsets = offsets[0];
	var firstOffset = patternOffsets.FirstOffset;
	var secondOffset = patternOffsets.SecondOffset;

	// Apply the first sequence patch
	var patchedBytes = patch.FirstSequence.Patched;
	Array.Copy(patchedBytes, 0, originalBytes, firstOffset, patchedBytes.Length);

	// Apply the second sequence patch
	patchedBytes = patch.SecondSequence.Patched;
	Array.Copy(patch.SecondSequence.Patched, 0, originalBytes, secondOffset, patchedBytes.Length);

	// Write the patched bytes to the output file
	File.WriteAllBytes(outputPath, originalBytes);

	Console.WriteLine(&quot;Patched file written to &quot; + outputPath);
	return true;
}" style="color:#adbac7;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki github-dark-dimmed" style="background-color: #22272e" tabindex="0"><code><span class="line"><span style="color: #F47067">public</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">static</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">bool</span><span style="color: #ADBAC7"> </span><span style="color: #DCBDFB">Apply</span><span style="color: #ADBAC7">(</span><span style="color: #F47067">string</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">inputPath</span><span style="color: #ADBAC7">, </span><span style="color: #F47067">string</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">outputPath</span><span style="color: #ADBAC7">, </span><span style="color: #F47067">string</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">patchFileText</span><span style="color: #ADBAC7">) {</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">byte</span><span style="color: #ADBAC7">[] </span><span style="color: #F69D50">originalBytes</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">=</span><span style="color: #ADBAC7"> File.</span><span style="color: #DCBDFB">ReadAllBytes</span><span style="color: #ADBAC7">(inputPath);</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F69D50">Patch</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">patch</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">=</span><span style="color: #ADBAC7"> </span><span style="color: #DCBDFB">ParsePatchFile</span><span style="color: #ADBAC7">(patchFileText);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F69D50">List</span><span style="color: #ADBAC7">&lt;</span><span style="color: #F69D50">PatternOffsets</span><span style="color: #ADBAC7">&gt; </span><span style="color: #F69D50">offsets</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">=</span><span style="color: #ADBAC7"> </span><span style="color: #DCBDFB">FindSequencePattern</span><span style="color: #ADBAC7">(originalBytes, patch.FirstSequence, patch.SecondSequence, patch.RelativeOffset);</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">if</span><span style="color: #ADBAC7"> (offsets.Count </span><span style="color: #F47067">==</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">0</span><span style="color: #ADBAC7">) {</span></span>
<span class="line"><span style="color: #ADBAC7">		Console.Error.</span><span style="color: #DCBDFB">WriteLine</span><span style="color: #ADBAC7">(</span><span style="color: #96D0FF">&quot;Error, pattern not found in target.&quot;</span><span style="color: #ADBAC7">);</span></span>
<span class="line"><span style="color: #ADBAC7">		</span><span style="color: #F47067">return</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">false</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">	}</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">if</span><span style="color: #ADBAC7"> (offsets.Count </span><span style="color: #F47067">&gt;</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">1</span><span style="color: #ADBAC7">) {</span></span>
<span class="line"><span style="color: #ADBAC7">		Console.Error.</span><span style="color: #DCBDFB">WriteLine</span><span style="color: #ADBAC7">(</span><span style="color: #96D0FF">&quot;Error, pattern found multiple times in target.&quot;</span><span style="color: #ADBAC7">);</span></span>
<span class="line"><span style="color: #ADBAC7">		</span><span style="color: #F47067">return</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">false</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">	}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADBAC7">	Console.</span><span style="color: #DCBDFB">WriteLine</span><span style="color: #ADBAC7">(</span><span style="color: #96D0FF">&quot;Sequence pattern found in target, patching...&quot;</span><span style="color: #ADBAC7">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">var</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">patternOffsets</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">=</span><span style="color: #ADBAC7"> offsets[</span><span style="color: #6CB6FF">0</span><span style="color: #ADBAC7">];</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">var</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">firstOffset</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">=</span><span style="color: #ADBAC7"> patternOffsets.FirstOffset;</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">var</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">secondOffset</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">=</span><span style="color: #ADBAC7"> patternOffsets.SecondOffset;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #768390">// Apply the first sequence patch</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">var</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">patchedBytes</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">=</span><span style="color: #ADBAC7"> patch.FirstSequence.Patched;</span></span>
<span class="line"><span style="color: #ADBAC7">	Array.</span><span style="color: #DCBDFB">Copy</span><span style="color: #ADBAC7">(patchedBytes, </span><span style="color: #6CB6FF">0</span><span style="color: #ADBAC7">, originalBytes, firstOffset, patchedBytes.Length);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #768390">// Apply the second sequence patch</span></span>
<span class="line"><span style="color: #ADBAC7">	patchedBytes </span><span style="color: #F47067">=</span><span style="color: #ADBAC7"> patch.SecondSequence.Patched;</span></span>
<span class="line"><span style="color: #ADBAC7">	Array.</span><span style="color: #DCBDFB">Copy</span><span style="color: #ADBAC7">(patch.SecondSequence.Patched, </span><span style="color: #6CB6FF">0</span><span style="color: #ADBAC7">, originalBytes, secondOffset, patchedBytes.Length);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #768390">// Write the patched bytes to the output file</span></span>
<span class="line"><span style="color: #ADBAC7">	File.</span><span style="color: #DCBDFB">WriteAllBytes</span><span style="color: #ADBAC7">(outputPath, originalBytes);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ADBAC7">	Console.</span><span style="color: #DCBDFB">WriteLine</span><span style="color: #ADBAC7">(</span><span style="color: #96D0FF">&quot;Patched file written to &quot;</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">+</span><span style="color: #ADBAC7"> outputPath);</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">return</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">true</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">}</span></span></code></pre>
</div>



<p>main patching method</p>



<div class="wp-block-kevinbatdorf-code-block-pro" style="font-size:.875rem;line-height:1.25rem">
<span role="button" tabindex="0" data-code="struct PatternOffsets {
	public int FirstOffset;
	public int SecondOffset;
}

struct SequencePair {
	public byte[] Original;
	public byte[] Patched;
}

class Patch {
	public SequencePair FirstSequence;
	public SequencePair SecondSequence;
	public int RelativeOffset;
}" style="color:#adbac7;display:none" aria-label="Copy" class="code-block-pro-copy-button"><svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px" fill="none" viewbox="0 0 24 24" stroke="currentColor" stroke-width="2"><path class="with-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path><path class="without-check" stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path></svg></span><pre class="shiki github-dark-dimmed" style="background-color: #22272e" tabindex="0"><code><span class="line"><span style="color: #F47067">struct</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">PatternOffsets</span><span style="color: #ADBAC7"> {</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">public</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">int</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">FirstOffset</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">public</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">int</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">SecondOffset</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F47067">struct</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">SequencePair</span><span style="color: #ADBAC7"> {</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">public</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">byte</span><span style="color: #ADBAC7">[] </span><span style="color: #F69D50">Original</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">public</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">byte</span><span style="color: #ADBAC7">[] </span><span style="color: #F69D50">Patched</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F47067">class</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">Patch</span><span style="color: #ADBAC7"> {</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">public</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">SequencePair</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">FirstSequence</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">public</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">SequencePair</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">SecondSequence</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">	</span><span style="color: #F47067">public</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">int</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">RelativeOffset</span><span style="color: #ADBAC7">;</span></span>
<span class="line"><span style="color: #ADBAC7">}</span></span></code></pre>
</div>



<p>data objects</p>



<h3 class="wp-block-heading">A Couple of Gotchas</h3>



<p class="has-text-color" style="color:rgb(0, 0, 0)">When writing this patcher, there were a couple of things to watch out for. Firstly, it was important to ensure that the two-byte sequences were found <em>in pairs</em>, with the relative offset between them. Otherwise, we might end up patching two entirely unrelated sequences that just happened to look similar.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">Secondly, even though the sequence pair is unlikely to occur more than once, I wanted to make sure that the patcher would stop patching if it did.</p>



<h1 class="wp-block-heading">Testing it üíØ</h1>



<p class="has-text-color" style="color:rgb(0, 0, 0)">While developing the patcher, I tested whether the assembly instructions were changed in the patched executable. Additionally, I confirmed with my colleague the specific compromised Intel hardware.</p>



<figure class="wp-block-table"><table>
<thead><tr>
<th>App</th>
<th>Engine</th>
<th>Patch compatible</th>
<th>Confirmed IDA</th>
<th>Confirmed on Hardware</th>
</tr></thead>
<tbody>
<tr>
<td>Besiege</td>
<td>Unity v5.4.0f3</td>
<td>‚úÖ</td>
<td>‚úÖ</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Unity Editor</td>
<td>Unity v5.4.0f3</td>
<td>‚úÖ</td>
<td>‚úÖ</td>
<td>‚úÖ</td>
</tr>
<tr>
<td>Test Game</td>
<td>Unreal 4.21.2</td>
<td>‚úÖ</td>
<td>‚úÖ</td>
<td>‚ùå</td>
</tr>
</tbody>
</table></figure>



<p class="has-text-color" style="color:rgb(0, 0, 0)">
The only app which I haven‚Äôt verified whether it would fix the crash on the specific Intel hardware is the Unreal Test Game. The test game itself is a boilerplate FPS Game template that comes with Unreal 4.21.2. I did verify the before and after in IDA and could confirm that it was compromised with the same faulty OpenSSL code and that the patch would fix it.</p>



<h1 class="wp-block-heading">Conclusion üèÅ</h1>



<p class="has-text-color" style="color:rgb(0, 0, 0)">With a little bit of effort, we were able to repurpose the existing, <a href="https://github.com/openssl/openssl/commit/7123aa81e9fb19afb11fdf3850662c5f7ff1f19c#diff-fd85954e17364d4495e1e077a5768e4e" target="_blank" rel="noreferrer noopener">internal OpenSSL library patch</a> into an all-purpose, universal binary patch.  Although, disclaimer: &#8220;universal&#8221; might be a stretch. This may work for these particular apps and engine versions, but it may not work for your particular situation.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">As a reminder, all code is available for free on GitHub: <a href="https://github.com/eamonwoortman/openssl-universal-patcher/">https://github.com/eamonwoortman/openssl-universal-patcher/</a>.</p>



<p class="has-text-color" style="color:rgb(0, 0, 0)">If you found this even slightly useful or an interesting read, please consider buying me a coffee! üôè</p>



<script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="eamonw" data-color="#FFDD00" data-emoji="" data-font="Cookie" data-text="Buy me a coffee" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff"></script>



<h1 class="wp-block-heading">Resources</h1>



<p class="has-text-color" style="color:rgb(0, 0, 0)">These links provide additional information and context for the topics discussed in the article:</p>



<h3 class="wp-block-heading">OpenSSL</h3>



<ul>
<li>
<a href="https://github.com/openssl/openssl/blob/c8093347f736c7991350d26048b680d0e64974a0/crypto/cpuid.c#L106" target="_blank" rel="noreferrer noopener">cpuid.c</a>: The <code>OPENSSL_cpuid_setup</code> function in the OpenSSL repository on GitHub that initializes the library by checking the processor vendor ID and feature flags.</li>



<li>
<a href="https://github.com/openssl/openssl/commit/7123aa81e9fb19afb11fdf3850662c5f7ff1f19c#diff-fd85954e17364d4495e1e077a5768e4e" target="_blank" rel="noreferrer noopener">OpenSSL 1.0.2L patch</a>: A commit in the OpenSSL repository that contains a patch for the library&#8217;s Intel-specific implementation of the SHA1 function.</li>



<li>
<a href="https://github.com/openssl/openssl" target="_blank" rel="noreferrer noopener">OpenSSL repository</a>: The GitHub repository for the OpenSSL library.</li>
</ul>



<h3 class="wp-block-heading">Tools</h3>



<ul>
<li>
<a href="https://github.com/mendsley/bsdiff" target="_blank" rel="noreferrer noopener">bsdiff.net</a>: A website that provides a binary diffing tool called BSDiff.</li>



<li>
<a href="https://github.com/LogosBible/bsdiff.net" target="_blank" rel="noreferrer noopener">bsdiff.net .NET port</a>: The .NET port of BSDiff available on GitHub.</li>



<li>
<a href="https://hex-rays.com/ida-free/" target="_blank" rel="noreferrer noopener">IDA</a>: A disassembler and debugger software that allows users to analyze binary code.</li>
</ul>



<h3 class="wp-block-heading">Other</h3>



<ul>
<li>Reddit post: <a href="https://www.reddit.com/r/gamedev/comments/49d0f3/openssl_binary_patching/" target="_blank" rel="noreferrer noopener">https://www.reddit.com/r/gamedev/comments/49d0f3/openssl_binary_patching/</a>
</li>



<li>Intel article: <a href="https://www.intel.com/content/www/us/en/developer/articles/troubleshooting/openssl-sha-crash-bug-requires-application-update.html" target="_blank" rel="noreferrer noopener">https://software.intel.com/content/www/us/en/develop/articles/openssl-ia32-capabilities-change-with-newer-generation-intel-processors.html</a>
</li>
</ul>

</div>
<!-- .entry -->

<div class="post-tags clr">
	<span class="owp-tag-text">Tags: </span><a href="https://eamonwoortman.github.io/tag/assembly/" rel="tag">assembly</a><span class="owp-sep">,</span> <a href="https://eamonwoortman.github.io/tag/ida/" rel="tag">Ida</a><span class="owp-sep">,</span> <a href="https://eamonwoortman.github.io/tag/openssl/" rel="tag">OpenSSL</a><span class="owp-sep">,</span> <a href="https://eamonwoortman.github.io/tag/unity/" rel="tag">Unity</a>
</div>




	<section id="related-posts" class="clr">

		<h3 class="theme-heading related-posts-title">
			<span class="text">You Might Also Like</span>
		</h3>

		<div class="oceanwp-row clr">

			
			
				
				<article class="related-post clr col span_1_of_4 col-1 post-172 post type-post status-publish format-standard has-post-thumbnail hentry category-general entry has-media">

					
						<figure class="related-post-media clr">

							<a href="https://eamonwoortman.github.io/new-website/" class="related-thumb">

								<img width="768" height="480" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground-768x480.jpg" class="lazy lazy-hidden attachment-medium_large size-medium_large wp-post-image" alt="Read more about the article New website!" itemprop="image" decoding="async" fetchpriority="high" data-lazy-srcset="https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground-768x480.jpg 768w, https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground-300x188.jpg 300w, https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground-1024x640.jpg 1024w, https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground.jpg 1680w" data-lazy-sizes="(max-width: 768px) 100vw, 768px"><noscript><img width="768" height="480" src="https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground-768x480.jpg" class="attachment-medium_large size-medium_large wp-post-image" alt="Read more about the article New website!" itemprop="image" decoding="async" fetchpriority="high" srcset="https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground-768x480.jpg 768w, https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground-300x188.jpg 300w, https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground-1024x640.jpg 1024w, https://eamonwoortman.github.io/wp-content/uploads/2017/01/codebackground.jpg 1680w" sizes="(max-width: 768px) 100vw, 768px"></noscript>							</a>

						</figure>

					
					<h3 class="related-post-title">
						<a href="https://eamonwoortman.github.io/new-website/" rel="bookmark">New website!</a>
					</h3>
<!-- .related-post-title -->

								
						<time class="published" datetime="2017-01-24T17:39:25+01:00"><i class=" icon-clock" aria-hidden="true" role="img"></i>January 24, 2017</time>
						

				</article><!-- .related-post -->

				
			
				
				<article class="related-post clr col span_1_of_4 col-2 post-379 post type-post status-publish format-standard has-post-thumbnail hentry category-general entry has-media">

					
						<figure class="related-post-media clr">

							<a href="https://eamonwoortman.github.io/dockerhub-profile-wordpress-widget/" class="related-thumb">

								<img width="768" height="427" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-type="image" data-lazy-src="https://eamonwoortman.github.io/wp-content/uploads/2017/02/docker-hub-profile-logo-768x427.png" class="lazy lazy-hidden attachment-medium_large size-medium_large wp-post-image" alt="Read more about the article Docker Hub Profile WordPress widget" itemprop="image" decoding="async" data-lazy-srcset="https://eamonwoortman.github.io/wp-content/uploads/2017/02/docker-hub-profile-logo-768x427.png 768w, https://eamonwoortman.github.io/wp-content/uploads/2017/02/docker-hub-profile-logo-300x167.png 300w, https://eamonwoortman.github.io/wp-content/uploads/2017/02/docker-hub-profile-logo.png 899w" data-lazy-sizes="(max-width: 768px) 100vw, 768px"><noscript><img width="768" height="427" src="https://eamonwoortman.github.io/wp-content/uploads/2017/02/docker-hub-profile-logo-768x427.png" class="attachment-medium_large size-medium_large wp-post-image" alt="Read more about the article Docker Hub Profile WordPress widget" itemprop="image" decoding="async" srcset="https://eamonwoortman.github.io/wp-content/uploads/2017/02/docker-hub-profile-logo-768x427.png 768w, https://eamonwoortman.github.io/wp-content/uploads/2017/02/docker-hub-profile-logo-300x167.png 300w, https://eamonwoortman.github.io/wp-content/uploads/2017/02/docker-hub-profile-logo.png 899w" sizes="(max-width: 768px) 100vw, 768px"></noscript>							</a>

						</figure>

					
					<h3 class="related-post-title">
						<a href="https://eamonwoortman.github.io/dockerhub-profile-wordpress-widget/" rel="bookmark">Docker Hub Profile WordPress widget</a>
					</h3>
<!-- .related-post-title -->

								
						<time class="published" datetime="2017-02-26T18:32:25+01:00"><i class=" icon-clock" aria-hidden="true" role="img"></i>February 26, 2017</time>
						

				</article><!-- .related-post -->

				
			
		</div>
<!-- .oceanwp-row -->

	</section><!-- .related-posts -->




<section id="comments" class="comments-area clr has-comments">

	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://eamonwoortman.github.io/openssl-binary-patching/#respond" style="display:none;">Cancel reply</a></small>
</h3>
<form action="https://eamonwoortman.github.io/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate>
<div class="comment-textarea">
<label for="comment" class="screen-reader-text">Comment</label><textarea name="comment" id="comment" cols="39" rows="4" tabindex="0" class="textarea-comment" placeholder="Your comment here..."></textarea>
</div>
<div class="comment-form-author">
<label for="author" class="screen-reader-text">Enter your name or username to comment</label><input type="text" name="author" id="author" value="" placeholder="Name (required)" size="22" tabindex="0" aria-required="true" class="input-name">
</div>
<div class="comment-form-email">
<label for="email" class="screen-reader-text">Enter your email address to comment</label><input type="text" name="email" id="email" value="" placeholder="Email (required)" size="22" tabindex="0" aria-required="true" class="input-email">
</div>
<div class="comment-form-url">
<label for="url" class="screen-reader-text">Enter your website URL (optional)</label><input type="text" name="url" id="url" value="" placeholder="Website" size="22" tabindex="0" class="input-website">
</div>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="720" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p>
<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="f9dce101c3"></p>
<p style="display: none !important;"><label>&#916;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="243"><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p>
</form>	</div>
<!-- #respond -->
	
</section><!-- #comments -->

</article>

				
			</div>
<!-- #content -->

			
		</div>
<!-- #primary -->

		
	</div>
<!-- #content-wrap -->

	

	</main><!-- #main -->

	
	
	
		
<footer id="footer" class="site-footer" itemscope="itemscope" itemtype="https://schema.org/WPFooter" role="contentinfo">

	
	<div id="footer-inner" class="clr">

		

<div id="footer-widgets" class="oceanwp-row clr">

	
	<div class="footer-widgets-inner container">

					<div class="footer-box span_1_of_4 col col-1">
							</div>
<!-- .footer-one-box -->

							<div class="footer-box span_1_of_4 col col-2">
									</div>
<!-- .footer-one-box -->
				
							<div class="footer-box span_1_of_4 col col-3 ">
									</div>
<!-- .footer-one-box -->
				
							<div class="footer-box span_1_of_4 col col-4">
									</div>
<!-- .footer-box -->
				
			
	</div>
<!-- .container -->

	
</div>
<!-- #footer-widgets -->



<div id="footer-bottom" class="clr">

	
	<div id="footer-bottom-inner" class="container clr">

		
			<div id="footer-bottom-menu" class="navigation clr">

				<div class="menu-main-navigation-menu-container"><ul id="menu-main-navigation-menu-2" class="menu">
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-290"><a href="https://eamonwoortman.github.io/">Home</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-323"><a href="https://eamonwoortman.github.io/blog/">Blog</a></li>
<li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-597"><a href="https://eamonwoortman.github.io/projects/">Projects</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-284"><a href="https://eamonwoortman.github.io/contact/">Contact</a></li>
</ul></div>
			</div>
<!-- #footer-bottom-menu -->

			
		
			<div id="copyright" class="clr" role="contentinfo">
				Copyright - OceanWP Theme by OceanWP			</div>
<!-- #copyright -->

			
	</div>
<!-- #footer-bottom-inner -->

	
</div>
<!-- #footer-bottom -->


	</div>
<!-- #footer-inner -->

	
</footer><!-- #footer -->

	
	
</div>
<!-- #wrap -->


</div>
<!-- #outer-wrap -->



<a aria-label="Scroll to the top of the page" href="#" id="scroll-top" class="scroll-top-right"><i class=" fa fa-angle-up" aria-hidden="true" role="img"></i></a>




<script src="https://eamonwoortman.github.io/wp-includes/js/comment-reply.min.js?ver=6.4.2" id="comment-reply-js" async data-wp-strategy="async"></script>
<script src="https://eamonwoortman.github.io/wp-includes/js/imagesloaded.min.js?ver=5.0.0" id="imagesloaded-js"></script>
<script id="oceanwp-main-js-extra">var oceanwpLocalize = {"nonce":"8c3bf40af5","isRTL":"","menuSearchStyle":"drop_down","mobileMenuSearchStyle":"disabled","sidrSource":null,"sidrDisplace":"1","sidrSide":"left","sidrDropdownTarget":"link","verticalHeaderTarget":"link","customScrollOffset":"0","customSelects":".woocommerce-ordering .orderby, #dropdown_product_cat, .widget_categories select, .widget_archive select, .single-product .variations_form .variations select","ajax_url":"https:\/\/eamonwoortman.github.io\/wp-admin\/admin-ajax.php","oe_mc_wpnonce":"4d88673aa2"};</script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/theme.min.js?ver=1.0" id="oceanwp-main-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/vendors/isotope.pkgd.min.js?ver=3.0.6" id="ow-isotop-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/blog-masonry.min.js?ver=1.0" id="oceanwp-blog-masonry-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/drop-down-mobile-menu.min.js?ver=1.0" id="oceanwp-drop-down-mobile-menu-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/drop-down-search.min.js?ver=1.0" id="oceanwp-drop-down-search-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/vendors/magnific-popup.min.js?ver=1.0" id="ow-magnific-popup-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/ow-lightbox.min.js?ver=1.0" id="oceanwp-lightbox-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/vendors/flickity.pkgd.min.js?ver=1.0" id="ow-flickity-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/ow-slider.min.js?ver=1.0" id="oceanwp-slider-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/scroll-effect.min.js?ver=1.0" id="oceanwp-scroll-effect-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/scroll-top.min.js?ver=1.0" id="oceanwp-scroll-top-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/themes/oceanwp/assets/js/select.min.js?ver=1.0" id="oceanwp-select-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/plugins/bj-lazy-load/js/bj-lazy-load.min.js?ver=2" id="BJLL-js"></script>
<script src="https://eamonwoortman.github.io/wp-content/plugins/code-block-pro/build/front/front.js?ver=8eb026fbc72eb8ed3635" id="kevinbatdorf-code-block-pro-view-script-js" data-wp-strategy="defer"></script>
<script id="kevinbatdorf-code-block-pro-view-script-js-after">window.codeBlockPro = {"pluginUrl":"https:\/\/eamonwoortman.github.io\/wp-content\/plugins\/code-block-pro\/"};</script>
<script defer src="https://eamonwoortman.github.io/wp-content/plugins/akismet/_inc/akismet-frontend.js?ver=1702239890" id="akismet-frontend-js"></script>
</body>
</html>